"use strict";(self.webpackChunkanyshake_org=self.webpackChunkanyshake_org||[]).push([[8282],{5192:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>r,contentTitle:()=>c,default:()=>m,frontMatter:()=>i,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"anyshake-explorer/Data Protocol/protocol-v1-legacy","title":"Protocol v1 (Legacy)","description":"This document describes the communication protocol used for device configuration and data transmission.","source":"@site/docs/anyshake-explorer/Data Protocol/protocol-v1-legacy.md","sourceDirName":"anyshake-explorer/Data Protocol","slug":"/anyshake-explorer/Data Protocol/protocol-v1-legacy","permalink":"/docs/anyshake-explorer/Data Protocol/protocol-v1-legacy","draft":false,"unlisted":false,"editUrl":"https://github.com/anyshake/homepage/blob/master/docs/anyshake-explorer/Data Protocol/protocol-v1-legacy.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Protocol v1 (Legacy)","slug":"protocol-v1-legacy"},"sidebar":"tutorialSidebar","previous":{"title":"Firmware Upgrade","permalink":"/docs/anyshake-explorer/E-D001/advanced-operations/firmware-upgrade"},"next":{"title":"Observer Software Overview","permalink":"/docs/anyshake-observer/software-overview"}}');var l=t(4848),a=t(8453);const i={sidebar_position:1,title:"Protocol v1 (Legacy)",slug:"protocol-v1-legacy"},c=void 0,r={},d=[{value:"Packet Structure",id:"packet-structure",level:2},{value:"HEADER",id:"header",level:2},{value:"CHANNEL_Z",id:"channel_z",level:2},{value:"CHANNEL_E",id:"channel_e",level:2},{value:"CHANNEL_N",id:"channel_n",level:2},{value:"XOR_CHECKSUM",id:"xor_checksum",level:2},{value:"PADDING",id:"padding",level:2}];function h(e){const s={annotation:"annotation",code:"code",h2:"h2",math:"math",mfrac:"mfrac",mn:"mn",mo:"mo",mrow:"mrow",mtext:"mtext",p:"p",pre:"pre",semantics:"semantics",span:"span",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,a.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.p,{children:"This document describes the communication protocol used for device configuration and data transmission."}),"\n",(0,l.jsx)(s.h2,{id:"packet-structure",children:"Packet Structure"}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{style:{textAlign:"left"},children:"Bit Range"}),(0,l.jsx)(s.th,{style:{textAlign:"left"},children:"Name"}),(0,l.jsx)(s.th,{style:{textAlign:"left"},children:"Bytes"}),(0,l.jsx)(s.th,{style:{textAlign:"left"},children:"Remarks"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{style:{textAlign:"left"},children:"[65]"}),(0,l.jsx)(s.td,{style:{textAlign:"left"},children:"PADDING"}),(0,l.jsx)(s.td,{style:{textAlign:"left"},children:"1"}),(0,l.jsx)(s.td,{style:{textAlign:"left"},children:"Padding bytes, always 0"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{style:{textAlign:"left"},children:"[64:62]"}),(0,l.jsx)(s.td,{style:{textAlign:"left"},children:"CHECKSUM"}),(0,l.jsx)(s.td,{style:{textAlign:"left"},children:"3"}),(0,l.jsx)(s.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{style:{textAlign:"left"},children:"[61:42]"}),(0,l.jsx)(s.td,{style:{textAlign:"left"},children:"CHANNEL_N"}),(0,l.jsx)(s.td,{style:{textAlign:"left"},children:"20"}),(0,l.jsx)(s.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{style:{textAlign:"left"},children:"[41:22]"}),(0,l.jsx)(s.td,{style:{textAlign:"left"},children:"CHANNEL_E"}),(0,l.jsx)(s.td,{style:{textAlign:"left"},children:"20"}),(0,l.jsx)(s.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{style:{textAlign:"left"},children:"[21:2]"}),(0,l.jsx)(s.td,{style:{textAlign:"left"},children:"CHANNEL_Z"}),(0,l.jsx)(s.td,{style:{textAlign:"left"},children:"20"}),(0,l.jsx)(s.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{style:{textAlign:"left"},children:"[1:0]"}),(0,l.jsx)(s.td,{style:{textAlign:"left"},children:"HEADER"}),(0,l.jsx)(s.td,{style:{textAlign:"left"},children:"2"}),(0,l.jsx)(s.td,{style:{textAlign:"left"}})]})]})]}),"\n",(0,l.jsx)(s.p,{children:"The packet is fixed length of 66 bytes, sending interval is determined by sampling rate, using the following formula:"}),"\n",(0,l.jsx)(s.span,{className:"katex-display",children:(0,l.jsxs)(s.span,{className:"katex",children:[(0,l.jsx)(s.span,{className:"katex-mathml",children:(0,l.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,l.jsxs)(s.semantics,{children:[(0,l.jsxs)(s.mrow,{children:[(0,l.jsx)(s.mtext,{children:"SEND\xa0INTERVAL"}),(0,l.jsx)(s.mo,{children:"="}),(0,l.jsxs)(s.mfrac,{children:[(0,l.jsxs)(s.mrow,{children:[(0,l.jsx)(s.mn,{children:"5"}),(0,l.jsx)(s.mo,{children:"\u22c5"}),(0,l.jsx)(s.mn,{children:"1000"})]}),(0,l.jsx)(s.mtext,{children:"SAMPLE\xa0RATE"})]})]}),(0,l.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\text{SEND INTERVAL} = \\frac{5 \\cdot 1000}{\\text{SAMPLE RATE}}"})]})})}),(0,l.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"0.6833em"}}),(0,l.jsx)(s.span,{className:"mord text",children:(0,l.jsx)(s.span,{className:"mord",children:"SEND\xa0INTERVAL"})}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,l.jsx)(s.span,{className:"mrel",children:"="}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"2.0074em",verticalAlign:"-0.686em"}}),(0,l.jsxs)(s.span,{className:"mord",children:[(0,l.jsx)(s.span,{className:"mopen nulldelimiter"}),(0,l.jsx)(s.span,{className:"mfrac",children:(0,l.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(s.span,{className:"vlist-r",children:[(0,l.jsxs)(s.span,{className:"vlist",style:{height:"1.3214em"},children:[(0,l.jsxs)(s.span,{style:{top:"-2.314em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(s.span,{className:"mord",children:(0,l.jsx)(s.span,{className:"mord text",children:(0,l.jsx)(s.span,{className:"mord",children:"SAMPLE\xa0RATE"})})})]}),(0,l.jsxs)(s.span,{style:{top:"-3.23em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(s.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,l.jsxs)(s.span,{style:{top:"-3.677em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsxs)(s.span,{className:"mord",children:[(0,l.jsx)(s.span,{className:"mord",children:"5"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(s.span,{className:"mbin",children:"\u22c5"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(s.span,{className:"mord",children:"1000"})]})]})]}),(0,l.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(s.span,{className:"vlist-r",children:(0,l.jsx)(s.span,{className:"vlist",style:{height:"0.686em"},children:(0,l.jsx)(s.span,{})})})]})}),(0,l.jsx)(s.span,{className:"mclose nulldelimiter"})]})]})]})]})}),"\n",(0,l.jsx)(s.p,{children:"To get the current sampling rate in receiver end, calculate the time difference between two consecutive packets and using the following formula:"}),"\n",(0,l.jsx)(s.span,{className:"katex-display",children:(0,l.jsxs)(s.span,{className:"katex",children:[(0,l.jsx)(s.span,{className:"katex-mathml",children:(0,l.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,l.jsxs)(s.semantics,{children:[(0,l.jsxs)(s.mrow,{children:[(0,l.jsx)(s.mtext,{children:"SAMPLE\xa0RATE"}),(0,l.jsx)(s.mo,{children:"="}),(0,l.jsxs)(s.mfrac,{children:[(0,l.jsxs)(s.mrow,{children:[(0,l.jsx)(s.mn,{children:"5"}),(0,l.jsx)(s.mo,{children:"\u22c5"}),(0,l.jsx)(s.mn,{children:"1000"})]}),(0,l.jsx)(s.mtext,{children:"TIME\xa0DIFFERENCE"})]})]}),(0,l.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\text{SAMPLE RATE} = \\frac{5 \\cdot 1000}{\\text{TIME DIFFERENCE}}"})]})})}),(0,l.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"0.6833em"}}),(0,l.jsx)(s.span,{className:"mord text",children:(0,l.jsx)(s.span,{className:"mord",children:"SAMPLE\xa0RATE"})}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,l.jsx)(s.span,{className:"mrel",children:"="}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"2.0074em",verticalAlign:"-0.686em"}}),(0,l.jsxs)(s.span,{className:"mord",children:[(0,l.jsx)(s.span,{className:"mopen nulldelimiter"}),(0,l.jsx)(s.span,{className:"mfrac",children:(0,l.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(s.span,{className:"vlist-r",children:[(0,l.jsxs)(s.span,{className:"vlist",style:{height:"1.3214em"},children:[(0,l.jsxs)(s.span,{style:{top:"-2.314em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(s.span,{className:"mord",children:(0,l.jsx)(s.span,{className:"mord text",children:(0,l.jsx)(s.span,{className:"mord",children:"TIME\xa0DIFFERENCE"})})})]}),(0,l.jsxs)(s.span,{style:{top:"-3.23em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(s.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,l.jsxs)(s.span,{style:{top:"-3.677em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsxs)(s.span,{className:"mord",children:[(0,l.jsx)(s.span,{className:"mord",children:"5"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(s.span,{className:"mbin",children:"\u22c5"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(s.span,{className:"mord",children:"1000"})]})]})]}),(0,l.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(s.span,{className:"vlist-r",children:(0,l.jsx)(s.span,{className:"vlist",style:{height:"0.686em"},children:(0,l.jsx)(s.span,{})})})]})}),(0,l.jsx)(s.span,{className:"mclose nulldelimiter"})]})]})]})]})}),"\n",(0,l.jsx)(s.h2,{id:"header",children:"HEADER"}),"\n",(0,l.jsx)(s.p,{children:"The packet header is a 2-byte field that marks the beginning of a packet."}),"\n",(0,l.jsxs)(s.p,{children:["It is set to ",(0,l.jsx)(s.code,{children:"FC 1B"})," in this version of the protocol."]}),"\n",(0,l.jsx)(s.h2,{id:"channel_z",children:"CHANNEL_Z"}),"\n",(0,l.jsxs)(s.p,{children:["The ",(0,l.jsx)(s.code,{children:"CHANNEL_Z"})," field is a 20-byte field that holds 5 samples of Z-axis acceleration data in int32 format."]}),"\n",(0,l.jsx)(s.h2,{id:"channel_e",children:"CHANNEL_E"}),"\n",(0,l.jsxs)(s.p,{children:["The ",(0,l.jsx)(s.code,{children:"CHANNEL_E"})," field is a 20-byte field that holds 5 samples of E-axis acceleration data in int32 format."]}),"\n",(0,l.jsx)(s.h2,{id:"channel_n",children:"CHANNEL_N"}),"\n",(0,l.jsxs)(s.p,{children:["The ",(0,l.jsx)(s.code,{children:"CHANNEL_N"})," field is a 20-byte field that holds 5 samples of N-axis acceleration data in int32 format."]}),"\n",(0,l.jsx)(s.h2,{id:"xor_checksum",children:"XOR_CHECKSUM"}),"\n",(0,l.jsxs)(s.p,{children:["The field is divided into 3 bytes, corresponding to the checksum of ",(0,l.jsx)(s.code,{children:"CHANNEL_Z"}),", ",(0,l.jsx)(s.code,{children:"CHANNEL_E"})," and ",(0,l.jsx)(s.code,{children:"CHANNEL_N"})," respectively."]}),"\n",(0,l.jsx)(s.p,{children:"C example given below:"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-cpp",children:"void get_checksum(int32_t *z_samples, int32_t *e_samples, int32_t *n_samples, uint8_t *calc_checksum) {\n    uint8_t* bytes = (uint8_t*)&z_samples;\n    for (uint8_t i = 0; i < 5; i++) {\n        calc_checksum[0] ^= bytes[i];\n    }\n\n    bytes = (uint8_t*)&e_samples;\n    for (uint8_t i = 0; i < 5; i++) {\n        calc_checksum[1] ^= bytes[i];\n    }\n\n    bytes = (uint8_t*)&n_samples;\n    for (uint8_t i = 0; i < 5; i++) {\n        calc_checksum[2] ^= bytes[i];\n    }\n}\n\nint main() {\n    int32_t channel_z_samples[] = { 10, 20, 30, 40, 50 };\n    int32_t channel_e_samples[] = { 60, 70, 80, 90, 100 };\n    int32_t channel_n_samples[] = { 110, 120, 130, 140, 150 };\n\n    uint8_t calc_checksum[3];\n    get_checksum(channel_z_samples, channel_e_samples, channel_n_samples, calc_checksum);\n\n    // ... other parts ...\n}\n"})}),"\n",(0,l.jsx)(s.h2,{id:"padding",children:"PADDING"}),"\n",(0,l.jsxs)(s.p,{children:["The ",(0,l.jsx)(s.code,{children:"PADDING"})," field is a 1-byte field that is always set to 0 in this version of the protocol."]})]})}function m(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,l.jsx)(s,{...e,children:(0,l.jsx)(h,{...e})}):h(e)}},8453:(e,s,t)=>{t.d(s,{R:()=>i,x:()=>c});var n=t(6540);const l={},a=n.createContext(l);function i(e){const s=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),n.createElement(a.Provider,{value:s},e.children)}}}]);